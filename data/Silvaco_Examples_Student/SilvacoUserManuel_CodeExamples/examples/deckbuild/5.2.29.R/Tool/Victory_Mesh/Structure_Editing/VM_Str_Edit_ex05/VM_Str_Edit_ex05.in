# (c) Silvaco Inc., 2024

# Cropping a section from a 2D structure (CROP)

# Required Modules
#  Victory Process
#   -Core Simulator 
#  Victory Mesh
#   -2D Meshing

# Example Name
Set name=“VM_Str_Edit_ex05” 

####### PROCESS SIMULATION ####### 
# First structure with half a trench MOS gate.
GO victoryprocess simflags="-P 4"

INIT material=silicon from=1 to=2 depth=2 \
resolution=0.01,0.01 meshdepth=2 gasheight=2.5 \
flow.dim=2D_xz c.phosphorus=1E14

ETCH min material=silicon thickness=1.1 right.to.x=1.8
ETCH conformal thickness=0.2 material=silicon right.to.x=1.8

DEPOSIT conformal material=oxide thickness=0.01
ETCH material=oxide above=0
DEPOSIT material=polysilicon thickness=0 max

DOPING boron conc=1e20 gauss.sigma=0.05 peak=2

# Save simulation status for remeshing
SAVE name=$'name'_VP_Half_sv conformalstr

# Single half trench cell. Crop out part of the mesa 
# and the trench (from x=1.4 to 2) and remesh
GO victorymesh simflags="-P 4"

LOAD in="$'name'_VP_Half_sv"

# Crop out part of the mesa and the trench (from x=1.4 to 2)
CROP from="1.4,0" to="2,2"

REMESH delaunay 

# Base mesh
REFINE max.size=0.05 regions="*"

# Interface refinement but increase the distance over which
# the refinement grades over
REFINE max.interface.size=0.01 max.interface.distance=0.5 grading=linear

# Junction refinement
REFINE max.junction.size=0.02 grading="linear"

SAVE out="$'name'_VM_Crop"

victoryvisual \
$'name'_VP_Half_sv_exVC.str \
$'name'_VM_Crop.str

QUIT
